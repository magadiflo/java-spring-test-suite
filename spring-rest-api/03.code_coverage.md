# ğŸ§® Cobertura de cÃ³digo (Code Coverage)

---

La `cobertura de cÃ³digo` es una mÃ©trica que indica quÃ© porcentaje del cÃ³digo fuente ha sido ejecutado durante la
ejecuciÃ³n de las pruebas automatizadas.

Nos ayuda a identificar `quÃ© partes de la aplicaciÃ³n estÃ¡n correctamente verificadas mediante tests` y cuÃ¡les aÃºn no
se han probado.

En `IntelliJ IDEA`, podemos generar un reporte de cobertura de manera sencilla:

1. En la vista del proyecto, hacemos clic derecho sobre la raÃ­z del proyecto (`spring-rest-api`).
2. Seleccionamos la opciÃ³n `More Run/Debug` â†’ `Run 'All Tests' with Coverage`.
3. `IntelliJ` ejecutarÃ¡ todos los tests disponibles (`unitarios`, de `integraciÃ³n`, etc.) y al finalizar mostrarÃ¡ un
   reporte visual con el nivel de cobertura alcanzado.

El resultado se mostrarÃ¡ directamente en la vista del `IDE`, con un resumen general de los paquetes, clases y mÃ©todos
cubiertos por las pruebas, similar a la siguiente imagen:

![03.png](assets/03.png)

Incluso el resultado lo podemos exportar en formato `html` desde la propia vista del IDE para verlo en cualquier
navegador.

![04.png](assets/04.png)

### ğŸ“Š Interpretando el reporte de cobertura

Al ejecutar las pruebas con cobertura, `IntelliJ` genera un reporte que resume quÃ© porcentaje del cÃ³digo fue ejecutado
durante los tests.

Las columnas las podemos interpretar de la siguiente manera:

| Columna       | DescripciÃ³n                                                                                                                                                               |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Package**   | Muestra el nombre del paquete analizado.                                                                                                                                  |
| **Class, %**  | Mide quÃ© porcentaje de clases tienen cobertura parcial o total. Si una clase nunca se ejecuta en tests, no cuenta.                                                        |
| **Method, %** | Mide quÃ© mÃ©todos han sido ejecutados durante las pruebas. `Ideal: > 70 %` (significa que la mayorÃ­a del comportamiento se probÃ³).                                         |
| **Branch, %** | Mide cuÃ¡ntas rutas condicionales (`if`, `for`, `try/catch`, etc.) se probaron. `Ideal: > 70 %`, para asegurar que se probaron tanto caminos â€œpositivosâ€ como â€œnegativosâ€. |
| **Line, %**   | Mide lÃ­neas ejecutadas respecto al total. Es la `mÃ©trica mÃ¡s usada para evaluar la cobertura global`.                                                                     |

ğŸŸ©ğŸŸ¨ğŸŸ¥ Colores en el reporte (dentro del IDE)

- ğŸŸ© Verde: cÃ³digo cubierto por pruebas.
- ğŸŸ¨ Amarillo: cobertura parcial (solo una parte de las ramas fue ejecutada).
- ğŸŸ¥ Rojo: cÃ³digo no cubierto.
- â¬œ Gris: cÃ³digo no aplicable (por ejemplo, interfaces o clases sin lÃ³gica ejecutable).

### ğŸ§­ 1. Resumen general del proyecto

En la tabla `â€œOverall Coverage Summaryâ€`, vemos nuestras mÃ©tricas globales:

| MÃ©trica      | % Cobertura | Total (cubiertos / totales) | QuÃ© significa                                                                     |
|--------------|-------------|-----------------------------|-----------------------------------------------------------------------------------|
| **Class %**  | **68.4%**   | (13 / 19)                   | 13 de 19 clases tienen al menos una parte probada                                 |
| **Method %** | **51.4%**   | (36 / 70)                   | 36 de 70 mÃ©todos fueron ejecutados por algÃºn test                                 |
| **Branch %** | **50%**     | (4 / 8)                     | Solo la mitad de las ramas condicionales (if/else, switch, etc.) fueron cubiertas |
| **Line %**   | **54.1%**   | (105 / 194)                 | Se ejecutaron 105 de 194 lÃ­neas de cÃ³digo durante los tests                       |

> La cobertura global real de cÃ³digo es del `54.1 %`.

### ğŸ§­ 2. Cobertura por paquete

| Paquete             | Line % | ObservaciÃ³n                                                                         |
|---------------------|--------|-------------------------------------------------------------------------------------|
| `dev.magadiflo.app` | 50 %   | Clase principal (`SpringRestApiApplication`), no relevante testearla mucho          |
| `controller`        | 55 %   | Cobertura media; serÃ­a bueno tener tests de integraciÃ³n con MockMvc o WebTestClient |
| `dto`               | 70 %   | Buena cobertura, probablemente tests indirectos o simples getters/setters           |
| `entity`            | 50 %   | Normal que sea baja; usualmente se prueba mediante repositorios o servicios         |
| `exception`         | 29.2 % | Muy baja; serÃ­a ideal incluir pruebas de manejo de errores                          |
| `service.impl`      | 63.6 % | Tu capa de negocio estÃ¡ razonablemente cubierta, aunque aÃºn puede mejorar           |

### ğŸ¯ 3. ConclusiÃ³n y recomendaciÃ³n

- Cobertura global actual: ğŸŸ  `54.1 %`
- Meta recomendada: ğŸŸ¢ `â‰¥ 70 â€“ 80 %`
- Nuestra situaciÃ³n:
    - Estamos por debajo del rango recomendado, lo cual es normal en etapas tempranas del proyecto.
    - Significa que nuestros tests actuales ejercitan un poco mÃ¡s de la mitad del cÃ³digo fuente.

### ğŸ“ˆ Recomendaciones para mejorar:

- EnfÃ³cate en los servicios y controladores, que son los puntos mÃ¡s crÃ­ticos.
- Agrega pruebas negativas (errores, excepciones, validaciones).
- Aumenta el uso de MockMvc / WebTestClient y Mockito para cubrir ramas condicionales.
- No te obsesiones con 100 % â€” busca un equilibrio entre cobertura y valor real de los tests.
